<!DOCTYPE html>
<html lang="en">

<head>
    <title>Super Bike </title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="css\home.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">


     
    <style>
     
.bike-card {
    float: left;
    width: 30%;
    margin: 1.5%;
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
}
.bike-card img {
    width: 100%;
    height: auto;
}
.bike-card .w3-container {
    padding: 15px;
}
.bike-card .w3-container h3 {
    text-align: center;
}
.bike-card .w3-container .price, .bike-card .w3-container .model, .bike-card .w3-container .Mileage {
    font-size: 14px;
    margin: 5px 0;
}
.bike-card .w3-container .price i, .bike-card .w3-container .model i, .bike-card .w3-container .Mileage i {
    color: #007bff; /* Blue color */
    margin-right: 5px;
}
.bike-card .w3-button {
    width: 100%;
    margin-top: 10px;
}

  /* Form styling */
  #bikeTab {
    background-color: #f2f2f2;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    max-width: 400px;
    margin: 0 auto;
}

h2 {
    color: #333;
    font-size: 24px;
    margin-bottom: 20px;
}

.form-group {
    margin-bottom: 20px;
}

label {
    display: block;
    font-weight: bold;
    margin-bottom: 8px;
    color: #555;
}

input[type="date"],
select {
    width: calc(100% - 12px);
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 16px;
}

select {
    background-color: #fff;
    color: #333;
    appearance: none;
    -webkit-appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='%23333' d='M7 10l5 5 5-5z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 8px center;
}

</style>
</head>

<body>
<header>
    


    <nav class="w3-sidebar w3-bar-block w3-black w3-card w3-animate-left w3-hide-medium w3-hide-large "
        style="display:none" id="mySidebar">
        <a href="javascript:void(0)" onclick="w3_close()" class="w3-bar-item w3-button w3-large w3-padding-16">Close
        </a>
        <a href="home.html" onclick="w3_close()" class="w3-bar-item w3-button">Home</a>
        <a href="aboutus.html" onclick="w3_close()" class="w3-bar-item w3-button">aboutus</a>
        <a href="contact.html" onclick="w3_close()" class="w3-bar-item w3-button">Contact</a>
        <a href="review.html" onclick="w3_close()" class="w3-bar-item w3-button">Review</a>
    </nav>
</header>

<nav class="navbar navbar-expand-lg navbar-light bg-dark-50">
    <div class="container">
        <div class="w-25 h-25">
            <a class="navbar-brand" 

                href="https://www.instagram.com/foodie_btech?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==">
                <img src="images\logo.png" alt="Logo" width="90" />
            </a>
        </div>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav mx-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="home.html">Home</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="contact.html">Contact</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="help.html">Any Help </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="review.html">Feedback</a>
                </li>
            </ul>
        </div>
        <a class="btn btn-white" href="javascript:void(0);" onclick="goBack()">
            <<< </a>

                <!-- Hide right-floated links on small screens and replace them with a menu icon -->
                <a href="javascript:void(0)" class="w3-bar-item w3-button w3-right w3-hide-large w3-hide-medium"
                    onclick="w3_open()">
                    <i class="fa fa-bars"></i>
                </a>
    </div>
</nav>

<nav class="w3-sidebar w3-bar-block w3-black w3-card w3-animate-left w3-hide-medium w3-hide-large "
    style="display:none" id="mySidebar">
    <a href="javascript:void(0)" onclick="w3_close()" class="w3-bar-item w3-button w3-large w3-padding-16">Close
    </a>
    <a href="home.html" onclick="w3_close()" class="w3-bar-item w3-button">Home</a>
    <a href="contact.html" onclick="w3_close()" class="w3-bar-item w3-button">Contact</a>
    <a href="help.html" onclick="w3_close()" class="w3-bar-item w3-button">Any Help</a>
    <a href="review.html" onclick="w3_close()" class="w3-bar-item w3-button">Review</a>
</nav>
</header>

<div style="background-color: #bcfad1;">

<br>
<!-- Bike Rental Tab -->
<div id="bikeTab">
    <div class="row">
        <center>
            <h2><i>Super Bike Details</i></h2>
        </center>
            <div class="col">
            <form id="bikeRentalForm">
                <div class="form-group">
                    <label for="bikePickupDate">Pick-up Date</label>
                    <input type="date" id="bikePickupDate"  class="form-control pickup-date" required />
                </div>
            </div>
            <div class="col">
                <div class="form-group">
                    <label for="bikeReturnDate">Return Date</label>
                    <input type="date" id="bikeReturnDate" class="form-control return-date" required />
                </div>
            </div>
        </div>
    </form>
</div>

<div class="border-top  mx-5 my-3"><br>


<div id="bikeContainer"></div></div>

<script>
    // JavaScript
    document.addEventListener("DOMContentLoaded", function() {
        // Get today's date in the format YYYY-MM-DD
        const today = new Date().toISOString().split('T')[0];
        
        // Set default value for pickup date and return date inputs
        document.getElementById("bikePickupDate").value = today;
        document.getElementById("bikeReturnDate").value = today;

        // Set min attribute for pickup date to today
        document.getElementById("bikePickupDate").setAttribute("min", today);
        document.getElementById("bikeReturnDate").setAttribute("min", today);

        // Add event listener to pickup date input to update min attribute of return date input
        document.getElementById("bikePickupDate").addEventListener("change", function() {
            const pickupDate = this.value;
            const returnDateInput = document.getElementById("bikeReturnDate");
            const returnDate = returnDateInput.value;
            
            // Ensure return date is not earlier than pickup date
            if (returnDate < pickupDate) {
               
                returnDateInput.value = pickupDate;
            }

            // Update min attribute of return date input
            returnDateInput.setAttribute("min", pickupDate);
        });
    });
</script>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Retrieve stored bike details from local storage
        const storedBikes = localStorage.getItem("bikesDetails");
        if (storedBikes) {
            const bikesDetails = JSON.parse(storedBikes);
            displayBikes(bikesDetails);
        }
    });
    
    function displayBikes(bikesDetails) {
        const bikeContainer = document.getElementById("bikeContainer");
    
        bikesDetails.forEach(function (bike) {
            const bikeCard = document.createElement("div");
            bikeCard.classList.add("w3-third", "w3-margin-bottom", "bike-card");
    
            const img = document.createElement("img");
            img.src = bike.image;
            img.alt = bike.name;
    
            const bikeInfoDiv = document.createElement("div");
            bikeInfoDiv.classList.add("w3-container", "w3-white");
    
            const bikeNameHeading = document.createElement("h3");
            bikeNameHeading.innerHTML = `<i style="color: #be5906;"><u>${bike.name}</u></i>`;
    
            const leftSide = document.createElement("div");
            leftSide.classList.add("left-side");
    
            const priceParagraph = document.createElement("p");
            priceParagraph.classList.add("price");
            priceParagraph.innerHTML = `<i class="fas fa-money-bill-wave"></i> Price: RS <span style="color: #881818;">${bike.price}</span> only`;
    
            const modelParagraph = document.createElement("p");
            modelParagraph.classList.add("model");
            modelParagraph.innerHTML = `<i class="fas fa-motorcycle"></i> Model: ${bike.model}`;
    
            leftSide.appendChild(priceParagraph);
            leftSide.appendChild(modelParagraph);
    
            const rightSide = document.createElement("div");
            rightSide.classList.add("right-side");
    
            const mileageParagraph = document.createElement("p");
            mileageParagraph.classList.add("mileage");
            mileageParagraph.innerHTML = `<i class="fas fa-road"></i> Mileage: ${bike.mileage}`;
    
            const chooseBtn = document.createElement("button");
            chooseBtn.classList.add("w3-button", "w3-black", "addBikeBtn");

             // Generate a unique ID for each bike
             const bikeId = generateUUID();
            chooseBtn.dataset.id = bikeId;
            chooseBtn.dataset.name = bike.name;
            chooseBtn.dataset.price = bike.price;
            chooseBtn.dataset.vehicleType = bike.vehicleType; // assuming there's a vehicle type property
            chooseBtn.textContent = "Choose Bike";
    
            // Add event listener to "Choose Bike" button
            chooseBtn.addEventListener("click", function() {
                const selectedBike = {
                    id: bikeId,
                    name: bike.name,
                    price: bike.price,
                    vehicleType: bike.vehicleType,
                    pickupDate: document.getElementById("bikePickupDate").value,
                    returnDate: document.getElementById("bikeReturnDate").value,
                    // Calculate number of days
                    numberOfDays: calculateNumberOfDays(document.getElementById("bikePickupDate").value, document.getElementById("bikeReturnDate").value)
                };
    
                // Check if both pickup and return dates are selected
                if (!selectedBike.pickupDate || !selectedBike.returnDate) {
                    alert("Please select both pickup and return dates.");
                    return;
                }
    
                // Retrieve existing bookings from local storage
                const existingBookings = JSON.parse(localStorage.getItem("bookingsNew")) || [];
    
                // Check if the selected bike is already booked for the selected dates
                const isAvailable = checkSelectedBikeAvailability(existingBookings, selectedBike);
    
                if (!isAvailable) {
                    // Bike is not available for the selected dates, show alert
                    alert("Sorry, the bike is not available for the selected dates.");
                    return;
                }
    
                // Store selected bike, pickup date, and return date in local storage
                const bookingData = {
                    bikeId: selectedBike.id,
                    bikeName: selectedBike.name,
                    pickupDate: selectedBike.pickupDate,
                    returnDate: selectedBike.returnDate,
                    price: selectedBike.price,
                    numberOfDays: selectedBike.numberOfDays
                };
                existingBookings.push(bookingData);
                localStorage.setItem("bookingsNew", JSON.stringify(existingBookings));
    
                // Redirect to the next page (customer.html)
                window.location.href = "customer.html";
            });
    
            bikeInfoDiv.appendChild(bikeNameHeading);
            bikeInfoDiv.appendChild(priceParagraph);
            bikeInfoDiv.appendChild(mileageParagraph);
            bikeInfoDiv.appendChild(modelParagraph);
            bikeInfoDiv.appendChild(chooseBtn);
    
            bikeCard.appendChild(img);
            bikeCard.appendChild(bikeInfoDiv);
    
            bikeContainer.appendChild(bikeCard);
        });
    }
    
    function calculateNumberOfDays(pickupDate, returnDate) {
        const oneDay = 24 * 60 * 60 * 1000; // hours*minutes*seconds*milliseconds
        const firstDate = new Date(pickupDate);
        const secondDate = new Date(returnDate);
        const diffDays = Math.round(Math.abs((firstDate - secondDate) / oneDay));
        return diffDays;
    }
    
    function checkSelectedBikeAvailability(existingBookings, selectedBike) {
    // Convert pickup and return dates to JavaScript Date objects
    const pickupDateTime = new Date(selectedBike.pickupDate).getTime();
    const returnDateTime = new Date(selectedBike.returnDate).getTime();

    // Iterate over existing bookings
    for (const booking of existingBookings) {
        // Convert booking pickup and return dates to JavaScript Date objects
        const bookingPickupDateTime = new Date(booking.pickupDate).getTime();
        const bookingReturnDateTime = new Date(booking.returnDate).getTime();

        // Check for overlap between booking dates and provided pickup/return dates
        if (
            (pickupDateTime < bookingReturnDateTime || pickupDateTime === bookingReturnDateTime) &&
            (returnDateTime > bookingPickupDateTime || returnDateTime === bookingPickupDateTime)
        ) {
            // Overlap found, now check if bike names match
            if (selectedBike.name === booking.bikeName) {
                // Bike with the same name is already booked for overlapping dates
                return false;
            }
        }
    }
    // No overlap found with any booking and no matching name found, bike is available
    return true;
}

    
    // Function to generate a UUID (Universally Unique Identifier)
    function generateUUID() { 
    // Generate a random timestamp within a reasonable range
    const timestamp = Date.now() - Math.floor(Math.random() * 10000000000); // Adjust range as needed

    // Convert the timestamp to a string and return
    return timestamp.toString();
}

    
    </script>
    

    


    
 
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
 <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/home.js"></script>
  


</body>

</html>